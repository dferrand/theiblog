<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>How big is my index? :: The i blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Description of the different sizes of an index." />
<meta name="keywords" content="ibmi, db2" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="http://10.0.0.148:1313/posts/how_big_is_my_index/" />





  
  <link rel="stylesheet" href="http://10.0.0.148:1313/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css">

  
  <link rel="stylesheet" href="http://10.0.0.148:1313/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css">

  
  <link rel="stylesheet" href="http://10.0.0.148:1313/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css">

  
  <link rel="stylesheet" href="http://10.0.0.148:1313/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css">

  
  <link rel="stylesheet" href="http://10.0.0.148:1313/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="http://10.0.0.148:1313/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css">

  
  <link rel="stylesheet" href="http://10.0.0.148:1313/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css">

  
  <link rel="stylesheet" href="http://10.0.0.148:1313/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css">

  
  <link rel="stylesheet" href="http://10.0.0.148:1313/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css">

  
  <link rel="stylesheet" href="http://10.0.0.148:1313/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css">

  
  <link rel="stylesheet" href="http://10.0.0.148:1313/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css">

  
  <link rel="stylesheet" href="http://10.0.0.148:1313/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css">

  
  <link rel="stylesheet" href="http://10.0.0.148:1313/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">


<link rel="stylesheet" href="http://10.0.0.148:1313/terminal.css">




<link rel="shortcut icon" href="http://10.0.0.148:1313/favicon.png">
<link rel="apple-touch-icon" href="http://10.0.0.148:1313/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="How big is my index?">
<meta property="og:description" content="Description of the different sizes of an index." />
<meta property="og:url" content="http://10.0.0.148:1313/posts/how_big_is_my_index/" />
<meta property="og:site_name" content="The i blog" />

  
  
  <meta property="og:image" content="http://10.0.0.148:1313/">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-10-27 08:00:00 -0400 EDT" />












</head>
<body>


<div class="container full">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="http://10.0.0.148:1313/">
  <div class="logo">
    The i blog
  </div>
</a>

    </div>
    
    
  </div>
  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="http://10.0.0.148:1313/posts/how_big_is_my_index/">How big is my index?</a>
  </h1>
  <div class="post-meta"><time class="post-date">2025-10-27</time><span class="post-author">Damien Ferrand</span><span class="post-reading-time">2 min read (414 words)</span></div>

  
    <span class="post-tags">
      
      #<a href="http://10.0.0.148:1313/tags/ibmi/">ibmi</a>&nbsp;
      
      #<a href="http://10.0.0.148:1313/tags/db2/">db2</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <p>While most objects on IBM i have a pretty well defined size, indices are a
different beast.</p>
<p>Let&rsquo;s consider a table TABLE1 containing 10k lines without any index, the table
is about 25MB. Let&rsquo;s now create an index called INDEX1. Let&rsquo;s now look at the
INDEX1 size with <code>DSPOBJD</code>: <img src="/posts/how_big_is_my_index/images/first_index_size.png" alt="First index size"></p>
<p>The actual size of the index is 14MB, the offline is 0 which is normal since the
index hasn&rsquo;t been saved yet.</p>
<p>If we duplicate INDEX1 to INDEX2 with <code>CRTDUPOBJ</code> and look at INDEX2 size with
<code>DSPOBJD</code>, we see its size is 49KB:
<img src="/posts/how_big_is_my_index/images/second_index_size.png" alt="Second index size"></p>
<p>The reason for this difference can be found in the joblog after <code>CRTDUPOBJ</code>, the
<code>CPI3210</code> message: <img src="/posts/how_big_is_my_index/images/cpi3210_message.png" alt="CPI3210 message"></p>
<p>Since INDEX1 and INDEX2 are the same, the system duplicated the <code>*FILE</code> object
but did not duplicate the access path which is the actual B-tree of the index.
Both <code>*FILE</code> objects share the same access path. This has the following
advantages:</p>
<ul>
<li>The access path is, by far, the biggest part of an index object, having only
one access path saves some disk space.</li>
<li>The database only has to maintain one access path when a record is added,
updated, or deleted in the underlying table, reducing the CPU and IO load.</li>
<li>The query optimizer only considers the access paths reducing the CPU load even
for SELECT operations.</li>
</ul>
<p>If we save INDEX1 and INDEX2 and look at their size with <code>DSPOBJD</code>:
<img src="/posts/how_big_is_my_index/images/first_index_size_after_save.png" alt="First index size after save">
<img src="/posts/how_big_is_my_index/images/second_index_size_after_save.png" alt="Second index size after save"></p>
<p>While the actual size hasn&rsquo;t changed for both indices (14MB and 49KB), the
offline size is now 14MB for both, that&rsquo;s because the offline size accounts for
all sections of the logical file whereas the size doesn&rsquo;t.</p>
<p>INDEX1 owns the access path, that&rsquo;s why it&rsquo;s reporting the full size. On the
other hand, INDEX2 uses the access path owned by INDEX1.</p>
<p>Using the <code>DSPFD</code> on the indices we can determine which one owns the access
path.</p>
<p>If we delete INDEX1 and check INDEX2 with <code>DSPOBJD</code>, we see its size was changed
to 14MB:
<img src="/posts/how_big_is_my_index/images/second_index_size_after_delete.png" alt="Second_index_size_after_delete"></p>
<p>That&rsquo;s because the system transfered the ownership of the access path to INDEX2
when INDEX1 was deleted without having to rebuild it.</p>
<p>Of course, duplicating an index is generally not very useful, fortunately the
system in also able to share access path in other cases, for example, if you
create an index INDEX1 on fields FldA and FldB and then create an index INDEX2
on FldA only, the system will reuse INDEX1 access path for INDEX2. Note that if
you were to create INDEX2 before INDEX1, there would be no sharing of access
path.</p>

      </div></div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>Â© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
